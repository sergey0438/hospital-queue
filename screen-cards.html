<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Екран черги</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { margin:0; font-family:sans-serif; background:#000; color:#fff; display:flex; flex-direction:column; align-items:center; min-height:100vh; }
.queue-container { display:grid; grid-template-columns:repeat(auto-fill,minmax(250px,1fr)); gap:1rem; padding:2rem; width:100%; max-width:1200px; margin-top:2rem; }
.patient-card { background:#d32f2f; color:#fff; border-radius:15px; padding:1.5rem; text-align:center; font-size:1.5rem; box-shadow:0 0 15px rgba(255,0,0,0.7); opacity:0; transform:translateY(-20px); transition:0.5s; }
.patient-card.show { opacity:1; transform:translateY(0); }
.patient-number { font-size:3rem; font-weight:bold; }
</style>
</head>
<body>
<h1 class="text-center mt-3">Електронна черга</h1>
<div class="queue-container" id="queueScreen"></div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "https://kharkiv-regional-default-rtdb.europe-west1.firebasedatabase.app/",
  authDomain: "hospital-queue.firebaseapp.com",
  databaseURL: "https://kharkiv-regional-default-rtdb.europe-west1.firebasedatabase.app/",
  projectId: "hospital-queue",
  storageBucket: "hospital-queue.appspot.com",
  messagingSenderId: "23042968926",
  appId: "1:23042968926:web:9c75f87c5337af630653cf"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const queueScreen = document.getElementById('queueScreen');
let currentCards = {};

function createCard(key, data){
  const card = document.createElement('div');
  card.className='patient-card';
  card.innerHTML=`<div class="patient-number">№${key}</div><div>${data.name}</div>`;
  queueScreen.appendChild(card);
  setTimeout(()=>card.classList.add('show'),50);
  return card;
}

db.ref('queue').on('value', snapshot => {
  const newKeys = new Set();
  snapshot.forEach(s=>{
    const data=s.val();
    const number=s.key;
    if(data.status==='waiting'){
      newKeys.add(number);
      if(!currentCards[number]) currentCards[number]=createCard(number,data);
    }
  });

  for(const key in currentCards){
    if(!newKeys.has(key)){
      const card=currentCards[key];
      card.classList.remove('show');
      setTimeout(()=>card.remove(),500);
      delete currentCards[key];
    }
  }
});
</script>
</body>
</html>
